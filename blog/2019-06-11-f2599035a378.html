<!DOCTYPE html>
<html lang="zh-cmn-Hans">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=devUIice-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <meta name="keywords" content="李瑞东 Pudge 广州 设计 design UI设计 体验设计 B端设计 设计作品 作品集"> 
    <meta name="author" content="李瑞东" />
    <meta name="robots" content="index,follow" />
    <meta name="google" content="index,follow" />
    <meta name="googlebot" content="index,follow" />
    <meta name="verify" content="index,follow" />
    <meta name="format-detection" content="telephone=no, email=no" />
    <!-- It may be good for SEO -->

    <title>最近用 Bodymovin 导出动画遇到的问题和解决方法 · 李瑞东 LRD.IM</title>
    <link rel="icon" type="image/png" sizes="32x32" href="../img/favicon/favicon-32x32.png">

    
    <!-- 防镜像 -->
    <script>if (window.location.host.search('lrd.im') || window.location.host.search('127.0.0.1')  == -1) {window.location.href = 'https://lrd.im';};</script>

    <!-- main css -->
    <link rel="stylesheet" href="../css/main.css">

    <!-- clipboard js -->
    <script src="../js/clipboard.min.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-112191540-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-112191540-2');
</script>

</head>
  <body>
    <!-- 导航栏-->
    <div class="container-fluid"> 
      <header class="box-header">
          <div class="vw">
          <a href="../index.html" alt="lrd.im 是设计师李瑞东的个人网站。">
              <div class="box-logo"></div>
          </a>
          <!-- nav-text -->
          <div class="nav-text-box">
              <p><a href="../project.html" class="nav-text">作品</a></p>
              <p><a href="../blog.html" class="nav-text">博客</a></p>
              <p><a href="../archive.html" class="nav-text">归档</a></p>
              <p><a href="../about.html" class="nav-text">关于我</a></p>
          </div>
          <div class="icon-menu" id="iconMenu"></div>
          <div class="icon-close hide" id="iconClose"></div>
      </div>
      </header>
  </div>
  <div class="nav-open hidden nav-transform" id="navOpen">
      <a href="../project.html">作品</a>
      <a href="../blog.html">博客</a>
      <a href="../archive.html">归档</a>
      <a href="../about.html">关于我</a>
  </div>
  <div class="nav-mask hidden" id="navMask"></div>
  <!-- end 导航栏-->
  <article class="h-entry">
<header>
<h1 class="p-name">最近用 Bodymovin 导出动画遇到的问题和解决方法</h1>
<p class="article-info">Pudge · <time>2019-06-11 </time>首次发布于 <a href="https://pudge1996.medium.com/%E6%9C%80%E8%BF%91%E7%94%A8-bodymovin-%E5%AF%BC%E5%87%BA%E5%8A%A8%E7%94%BB%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95-f2599035a378" target="_blank" class="vpn">Medium</a></p>
</header>
<section data-field="subtitle" class="p-summary">
本文记录作者用 Bodymovin 导出动画时遇到的各种各样奇怪问题，并提供可行的解决方案。持续更新
</section>
<section data-field="body" class="e-content">
<section class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading graf--title">最近用 Bodymovin 导出动画遇到的问题和解决方法</h3><figure class="graf graf--figure graf-after--h3"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*i5JsE2I_XZWadQu6Ektd1w.png" width="1000" height="437" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2019-06-11-f2599035a378/01.png"></figure><blockquote class="graf graf--blockquote graf-after--figure">本文记录作者用 Bodymovin 导出动画时遇到的各种各样奇怪问题，并提供可行的解决方案。持续更新</blockquote><h3 class="graf graf--h3 graf-after--blockquote">一、渐变色导出异常</h3><figure class="graf graf--figure graf-after--h3"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*iUciXDeMi6optvcy4svZ4w.png" width="1712" height="996" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2019-06-11-f2599035a378/02.png"><figcaption class="imageCaption">图1–1 渐变色导出异常</figcaption></figure><p class="graf graf--p graf-after--figure">渐变色导出后颜色异常，仅剩黑白双色的渐变，原因及解决方法：</p><p class="graf graf--p graf-after--p">原因一、使用了中文版的 After Effects，渐变填充的选项会变成中文名，使得导出后颜色异常。</p><pre class="graf graf--pre graf-after--p">解决方法：<br>方法1. 手动更改图层内“渐变填充”的效果为英文名或数字；<br>方法2. 更换为英文版 After Effects</pre><p class="graf graf--p graf-after--pre">原因二、未保存文件。</p><pre class="graf graf--pre graf-after--p">解决方法：<br>Cmd+S 设定一个路径保存 After Effects 源文件</pre><h3 class="graf graf--h3 graf-after--pre">二、修剪路径动画播放卡顿</h3><p class="graf graf--p graf-after--h3">制作某些路径动画我们需要在两帧内调换修剪路径的 “Start” 和 “End”，导出来的路径动画就会在这一瞬间会出现卡顿，如图2–1：</p><figure class="graf graf--figure graf-after--p"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*Bttf6HqUN3xXyQQdQTdvdQ.gif" width="800" height="600" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2019-06-11-f2599035a378/03.gif"><figcaption class="imageCaption">图2–1 修剪路径动画卡顿</figcaption></figure><p class="graf graf--p graf-after--figure">针对这个问题我发 Email 询问了插件的作者<br>hernan torrisi，这里是他回信的原文：</p><pre class="graf graf--pre graf-after--p">Hi, the problem is that the player interpolates between frames by default, so it’s trying to calculate values between two consecutive keyframes.<br>You can solve it by converting those keyframes to Hold Keyframes in AE, or you can call a method in the animation instance to prevent rendering in between frames:<br>anim.setSubframe(false)</pre><p class="graf graf--p graf-after--pre">我的理解是因为浏览器动画默认帧率和导出来的 JSON 动画帧率不一致，令浏览器自动在中间播放补间动画，即把调换修剪路径数值的两帧之间的动画也播放出来了，所以解决方法有两个：</p><pre class="graf graf--pre graf-after--p">解决方法：<br>方法1. 切换较前的一个关键帧为 <a href="https://helpx.adobe.com/after-effects/using/keyframe-interpolation.html" data-href="https://helpx.adobe.com/after-effects/using/keyframe-interpolation.html" class="markup--anchor markup--pre-anchor" rel="noopener" target="_blank">Hold Keyframes</a>（如图2-2）；<br>方法2. 设置禁用 Subframe，在前端代码中加一行 anim.setSubframe(false) 命令，（如图2-3）</pre><figure class="graf graf--figure graf-after--pre"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*2c0TyDwdK2hhZBSAwDvoMA.gif" width="800" height="600" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2019-06-11-f2599035a378/04.gif"><figcaption class="imageCaption">2–2 切换关键帧类型为 Hold Keyframes</figcaption></figure><figure class="graf graf--figure graf-after--figure"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*1KABu-qUCGbVUxapYqA_Ng.png" width="1092" height="880" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2019-06-11-f2599035a378/05.png"><figcaption class="imageCaption">图2–3 禁用 Subframe</figcaption></figure><h3 class="graf graf--h3 graf-after--figure">三、在 Mask 下的修剪路径动画显示异常</h3><p class="graf graf--p graf-after--h3">通常情况下我们为一个修剪路径动画加上 Mask， 路径动画会出现显示异常，如图3–1：</p><figure class="graf graf--figure graf-after--p"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*CDl2NLUYNO9bB5gGx3jUUw.gif" width="1200" height="600" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2019-06-11-f2599035a378/06.gif"><figcaption class="imageCaption">图3–1 路径动画显示异常</figcaption></figure><p class="graf graf--p graf-after--figure">这个问题我也问过插件作者，这里是他的原文</p><pre class="graf graf--pre graf-after--p">Yes, unfortunately browsers don&#39;t handle masks correctly when applied to strokes.</pre><pre class="graf graf--pre graf-after--pre">You can add a shape group with a rectangle that covers the whole surface of the stroke and a transparent fill mode in any layer that has a masked stroke and it will correct the artifact.</pre><p class="graf graf--p graf-after--pre">我的理解是浏览器对这个效果支持有问题，所以导致问题的产生。下面直接放解决方法：</p><pre class="graf graf--pre graf-after--p">解决方法：<br>1. 在做修剪路径的图层里新建一个 Group；<br>2. 在新的 Group 里创建一个矩形（或圆形，不重要）将其拖放至描边效果的上方，并使其大小覆盖整个 Mask 图层。<br>3. 调整第一步所添加的 Group 不透明度为0</pre><p class="graf graf--p graf-after--pre">这是作者给出的解决方法，但我个人尝试发现其实第1、3步可以省略（如图3–2），导出的动画也能正常显示。</p><figure class="graf graf--figure graf-after--p graf--trailing"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*bG37fKyEyMZ0hnVw3g3aUA.gif" width="1280" height="708" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2019-06-11-f2599035a378/07.gif"><figcaption class="imageCaption">图3–2 添加矩形，解决显示异常</figcaption></figure></div></div></section><section class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p class="graf graf--p graf--leading graf--trailing">以上是我近期遇到的一些问题和解决方案，在 Medium 上作记录。以后遇到问题也会在上面更新。</p></div></div></section>
</section>

<!-- 底部功能 -->
<hr class="end-dividers hr-1" data-content="分隔线">

<div class="article-navigation">
  <a href="2019-04-14-66746628e600.html" class="previous">
      <p>上一篇</p>
      <p class="title">在 iPhone 上安装旧版 Dribbble App</p>
  </a>
  <a href="2019-07-02-1b6d3ee82147.html" class="next">
    <p>下一篇</p>
    <p class="title">在 Sketch/PS 中导出 Display P3 广色域图片的方法</p>
  </a>
</div>

<hr class="end-dividers hr-2" data-content="分隔线">

<div class="footer-action">
  <div class="back-to-article"><a href="../blog.html"><span class="icon-back"></span>博客首页</a></div>
  <div class="copy-link" id="copyLink"><a href="javascript:" id="blogLink" data-clipboard-text="最近用 Bodymovin 导出动画遇到的问题和解决方法 https://lrd.im/blog/2019-06-11-f2599035a378.html" ><span class="icon-link"></span>复制链接</a></div>
  <div class="copied hide" id="copied"><a href="javascript:" data-clipboard-text="最近用 Bodymovin 导出动画遇到的问题和解决方法 https://lrd.im/blog/2019-06-11-f2599035a378.html"><span class="icon-success"></span>复制成功!</a></div>
  <div class="mobile-top"><a href="#" onclick="backToTop(4)"><span class="icon-top"></span>回到顶部</a></div>
</div>

<!-- back to top -->
<div class="to-top" id="toTop" onclick="backToTop(4)">
  <svg style="width:20px; height:40px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#232323">
      <path d="M277.375 427V167.296l119.702 119.702L427 256 256 85 85 256l29.924 29.922 119.701-118.626V427h42.75z"/>
  </svg>
</div>
<!-- end back to top -->
<!-- footer -->
<footer>
  <p class="copyright">© Pudge 2017-2021</p>
</footer>

<!-- end footer -->
</article>
<script src="https://cdn.jsdelivr.net/npm/zoom-vanilla.js/dist/zoom-vanilla.min.js"></script>
<script src="../js/lazysizes.min.js"></script>
<script src="../js/custom.js"></script>
</body>
</html>
