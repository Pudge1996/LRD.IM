<!DOCTYPE html>
<html lang="zh-cmn-Hans">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=devUIice-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <meta name="keywords" content="李瑞东 Pudge 广州 设计 design UI设计 体验设计 B端设计 设计作品 作品集"> 
    <meta name="author" content="李瑞东" />
    <meta name="robots" content="index,follow" />
    <meta name="google" content="index,follow" />
    <meta name="googlebot" content="index,follow" />
    <meta name="verify" content="index,follow" />
    <meta name="format-detection" content="telephone=no, email=no" />
    <!-- It may be good for SEO -->

    <title>用 AE 制作 Display P3 广色域动图的三个方法 · 李瑞东 LRD.IM</title>
    <link rel="icon" type="image/png" sizes="32x32" href="../img/favicon/favicon-32x32.png">

    <!-- main css -->
    <link rel="stylesheet" href="../css/main.css">

    <!-- clipboard js -->
    <script src="../js/clipboard.min.js"></script>
</head>
  <body>
    <!-- 导航栏-->
    <div class="container-fluid"> 
      <header class="box-header">
          <div class="vw">
          <a href="../index.html" alt="lrd.im 是设计师李瑞东的个人网站。">
              <div class="box-logo"></div>
          </a>
          <!-- nav-text -->
          <div class="nav-text-box">
              <p><a href="../portfolio.html" class="nav-text">作品</a></p>
              <p><a href="../blog.html" class="nav-text">博客</a></p>
              <p><a href="../archive.html" class="nav-text">归档</a></p>
              <p><a href="../about.html" class="nav-text">关于我</a></p>
          </div>
          <div class="icon-menu" id="iconMenu"></div>
          <div class="icon-close hide" id="iconClose"></div>
      </div>
      </header>
  </div>
  <div class="nav-open hidden nav-transform" id="navOpen">
      <a href="../portfolio.html">作品</a>
      <a href="../blog.html">博客</a>
      <a href="../archive.html">归档</a>
      <a href="../about.html">关于我</a>
  </div>
  <div class="nav-mask hidden" id="navMask"></div>
  <!-- end 导航栏-->
  <article class="h-entry">
<header>
<h1 class="p-name">用 AE 制作 Display P3 广色域动图的三个方法</h1>
<p class="article-info">Pudge · <time>2020-01-18 </time>首次发布于 <a href="https://pudge1996.medium.com/%E7%94%A8-ae-%E5%88%B6%E4%BD%9C-display-p3-%E5%B9%BF%E8%89%B2%E5%9F%9F%E5%8A%A8%E5%9B%BE%E7%9A%84%E4%B8%89%E4%B8%AA%E6%96%B9%E6%B3%95-b5646615e6ff" target="_blank">Medium</a></p>
</header>
<section data-field="subtitle" class="p-summary">
前段时间写了篇文章记录如何导出 P3 广色域静态图片，恰好最近工作上有需求要用到动画来完成，利用这次机会也记录一下制作支持 Display P3 广色域的 PNG 序列帧、CSS 精灵图和 APNG 三种格式动画的方法。
</section>
<section data-field="body" class="e-content">
<section class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading graf--title">用 AE 制作 Display P3 广色域动图的三个方法</h3><figure class="graf graf--figure graf-after--h3"><img class="graf-image lazyload" data-action="zoom" data-image-id="0*nuvNIzccliXzXLTi" width="3748" height="2632" data-unsplash-photo-id="3shfnfzdFVc" data-is-featured="true" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2020-01-18-b5646615e6ff/01.jpg"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@lastly?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com/@lastly?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-creator noopener" target="_blank">Tyler Lastovich</a> on <a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-source noopener" target="_blank">Unsplash</a></figcaption></figure><p class="graf graf--p graf-after--figure">前段时间写了篇<a href="2019-07-02-1b6d3ee82147.html" class="markup--anchor markup--p-anchor" target="_blank">文章</a>记录如何导出 P3 广色域静态图片，恰好最近工作上有需求要用到动画来完成，利用这次机会也记录一下制作支持 Display P3 广色域的 PNG 序列帧、CSS 精灵图和 APNG 三种格式动画的方法。</p><h3 class="graf graf--h3 graf-after--p">一、设置工作空间</h3><p class="graf graf--p graf-after--h3">首先不管使用什么方法，笔者建议先将 AE 的工作空间设置为 Display P3，目的是让设计师在 Display P3 广色域的工作空间内进行工作，更好地预览最终的效果。</p><p class="graf graf--p graf-after--p">将项目的颜色深度调至 16 位色彩，并且将工作空间设置为 Display P3，如图 1–1：</p><figure class="graf graf--figure graf-after--p"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*x2rKzFtd2wxMMebhSx92Wg.png" width="2430" height="1376" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2020-01-18-b5646615e6ff/02.png"><figcaption class="imageCaption">图 1–1 设置项目颜色空间为 Display P3</figcaption></figure><p class="graf graf--p graf-after--figure">设置工作空间后可以在下面 3 个方法中选取当前最适合你的方法使用，制作支持 Display P3 广色域的图片素材。</p><h3 class="graf graf--h3 graf-after--p">二、在 AE 中导出 Display P3 广色域 PNG 序列帧</h3><p class="graf graf--p graf-after--h3">帧动画的实现原理是不断切换视觉内图片内容，利用视觉滞留生理现象来实现连续播放的动画效果。所以我们需要在导出来的多张 PNG 文件素材里嵌入 Display P3 颜色描述文件。</p><ol class="postList"><li class="graf graf--li graf-after--p">将合成添加到渲染队列，设置通道、颜色深度，且在颜色管理页中设置 Display P3 为嵌入颜色描述文件，如图 2–1：</li></ol><figure class="graf graf--figure graf-after--li"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*RP_IdOleNVgHxmQKHPsEng.png" width="2430" height="1376" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2020-01-18-b5646615e6ff/03.png"><figcaption class="imageCaption">图 2–1 颜色设置：将描述文件嵌入至文件</figcaption></figure><p class="graf graf--p graf-after--figure">2. 执行渲染，得到序列帧文件，检查一下，确保导出来的图片颜色描述文件是 Display P3。如图 2–1：</p><figure class="graf graf--figure graf-after--p"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*6vdFeoyn3JrvRq8ac2bWxQ.png" width="2430" height="1376" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2020-01-18-b5646615e6ff/04.png"><figcaption class="imageCaption">图 2–2 检查文件颜色是否正确</figcaption></figure><h3 class="graf graf--h3 graf-after--figure">三、在 AE 中导出 Display P3 广色域 CSS Sprites（精灵图）</h3><p class="graf graf--p graf-after--h3">精灵图是一种 CSS 图像合并技术，将小图标和背景图像合并到一张图片上，然后利用 CSS 的背景定位来显示需要显示的图片部分。</p><p class="graf graf--p graf-after--p">这里笔者推荐使用 BigXiXi 制作的 <a href="https://github.com/bigxixi/CSS-Sprite-Exporter" data-href="https://github.com/bigxixi/CSS-Sprite-Exporter" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">CSS-Sprite-Exporter</a> 插件导出精灵图并生成相关的代码。因为该插件导出来的图片是默认嵌入工作空间的颜色描述文件的，所以只要保证第一步中工作空间设置正确，一键导出即可。如图 3–1</p><figure class="graf graf--figure graf-after--p"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*JKqnUooe_QNtCj4XKwvZJA.png" width="2430" height="1376" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2020-01-18-b5646615e6ff/05.png"><figcaption class="imageCaption">图 3–1 一键导出精灵图</figcaption></figure><p class="graf graf--p graf-after--figure">如下图，可见导出来的精灵图已经带有 Display P3 颜色描述文件。如图 3–2</p><figure class="graf graf--figure graf-after--p"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*fM_ViZudZTSL3LSdQXRfMA.png" width="2430" height="1376" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2020-01-18-b5646615e6ff/06.png"><figcaption class="imageCaption">图 3–2 检查文件颜色是否正确</figcaption></figure><p class="graf graf--p graf-after--figure">同理包括 Lottie 这类用代码控制位图播放的动画方式，也可以在导出后，确保位图素材是嵌入了 Display P3 的颜色描述文件，最终的动画也将能展现艳丽的色彩。</p><h3 class="graf graf--h3 graf-after--p">四、制作支持 Display P3 广色域的 APNG 动图</h3><p class="graf graf--p graf-after--h3">近几年似乎用 APNG 替代 GIF 的呼声越来越高，因为 GIF 的图片质量是在太烂了，我们用其他视觉效果更好、压缩效率更高的格式来代替 GIF，比如接下来要说的 APNG 格式。</p><p class="graf graf--p graf-after--p">1.首先在 AE 里制作好动画后，我们可以用多种方法来将动画转换成 APNG 格式的动图，例如 BigXiXi 制作的插件 <a href="https://github.com/bigxixi/webp_apng_exporter_for_AE" data-href="https://github.com/bigxixi/webp_apng_exporter_for_AE" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Webp/Apng Exporter</a> 直接在 AE 里导出，或者用 <a href="https://isparta.github.io/" data-href="https://isparta.github.io/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">iSparta</a> 将序列帧转换成 APNG 格式的动图。如图 3–1：</p><figure class="graf graf--figure graf-after--p"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*BtD_ka25bknl6p5CFnBdGg.png" width="2430" height="1377" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2020-01-18-b5646615e6ff/07.png"><figcaption class="imageCaption">图 3–1 导出 APNG 格式的动图</figcaption></figure><p class="graf graf--p graf-after--figure">2.然后双击该 APNG 动图（即用预览打开），点选 “工具” &gt; “指派描述文件” &gt;选择 Display P3 &gt; 点按 “好”，然后按 ⌘+S 保存文件后，你获得了一张支持 Display P3 广色域的 APNG 动图。如图 3–2：</p><figure class="graf graf--figure graf-after--p"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*sWwYDWbKv1WEtlrM7OaqYA.png" width="2430" height="1377" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2020-01-18-b5646615e6ff/08.png"><figcaption class="imageCaption">图 3–2 利用系统自带的“预览”APP 指派描述文件</figcaption></figure><h3 class="graf graf--h3 graf-after--figure">五、WebP 图片支持 Display P3 广色域图片吗？</h3><p class="graf graf--p graf-after--h3">根据官方介绍，WebP 格式的图片支持嵌入 ICC 颜色配置文件。</p><figure class="graf graf--figure graf-after--p"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*meqWEIvLnGDsy9tpG7o5Nw.png" width="2430" height="881" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2020-01-18-b5646615e6ff/09.png"><figcaption class="imageCaption">WebP 格式介绍 - <a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/automating-image-optimization#how-does-webp-perform" data-href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/automating-image-optimization#how-does-webp-perform" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">来源</a></figcaption></figure><p class="graf graf--p graf-after--figure">但目前笔者尝试了多种方法，都无法在浏览器中看到理想的 Display P3 色域 WebP 动图。</p><p class="graf graf--p graf-after--p">尝试过使用 WebP 官方制作工具 “webpmux” 将颜色描述文件嵌入至 WebP 动图中，虽然确实能成功嵌入，但图片颜色并没有转换过来。而将颜色描述文件嵌入至静态的 WebP 中，却能正常地显示艳丽的广色域图片。</p><figure class="graf graf--figure graf-after--p"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*SG0nHMQCHr6viPTqperIXg.png" width="2042" height="792" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2020-01-18-b5646615e6ff/10.png"><figcaption class="imageCaption">在同样设置颜色配置文件后，右边的静态图能正常显示颜色，而左边的动图却没有变化</figcaption></figure><p class="graf graf--p graf-after--figure">当时不确定这是工具的 BUG、或是我操作问题，还是 WebP 的动图不支持设置颜色配置文件？所以我将遇到的问题反馈到 <a href="https://bugs.chromium.org/p/webp/issues/detail?id=451" data-href="https://bugs.chromium.org/p/webp/issues/detail?id=451" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Chromium 社区</a>，很快得到了回复：</p><figure class="graf graf--figure graf-after--p"><img class="graf-image lazyload" data-action="zoom" data-image-id="1*7BEPdBUTZE0L5ikqYraSoQ.png" width="2430" height="689" data-src="https://lrdim.oss-cn-shenzhen.aliyuncs.com/blogimg/2020-01-18-b5646615e6ff/11.png"><figcaption class="imageCaption">关于浏览器无法正确显示 WebP 动图的颜色问题 — <a href="https://bugs.chromium.org/p/webp/issues/detail?id=451&amp;q=" data-href="https://bugs.chromium.org/p/webp/issues/detail?id=451&amp;q=" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">来自项目成员的回复</a></figcaption></figure><p class="graf graf--p graf-after--figure graf--trailing">大意是我们确实可以在 WebP 动图上嵌入颜色描述文件，但浏览器将其忽略了，即使用默认的 sRGB 颜色空间，似乎确实是一个 BUG？。</p></div></div></section><section class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p class="graf graf--p graf--leading graf--trailing">好吧这样看来，在作者心中动图的综合排名是 APNG &gt; PNG 序列 ≥ WebP &gt; GIF。APNG 支持嵌入颜色配置文件，又能完整支持透明通道（全透明和半透明），又可以无损压缩，实在是妙！</p></div></div></section>
</section>
<!-- 底部功能 -->
<hr class="end-dividers hr-1" data-content="分隔线">

<div class="article-navigation">
  <a href="2019-11-17-70cc6d2258fa.html" class="previous">
    <!-- <a href="#"> -->
      <p>上一篇</p>
      <p class="title">PingFang SC 不应该作为移动端网页字体的首选项</p>
    <!-- </a> -->
  </a>
  <a href="2020-04-07-bd9e4a9bd263.html" class="next">
    <p>下一篇</p>
    <p class="title">Dribbble 大改版，顺势记录下我对近期 UI 设计趋势和一些细节的观察</p>
  </a>
</div>

<hr class="end-dividers hr-2" data-content="分隔线">

<div class="footer-action">
  <div class="back-to-article"><a href="../blog.html"><span class="icon-back"></span>博客首页</a></div>
  <div class="copy-link" id="copyLink"><a href="javascript:" id="blogLink" data-clipboard-text="用 AE 制作 Display P3 广色域动图的三个方法 https://lrd.im/blog/2020-01-18-b5646615e6ff.html" ><span class="icon-link"></span>复制链接</a></div>
  <div class="copied hide" id="copied"><a href="javascript:" data-clipboard-text="用 AE 制作 Display P3 广色域动图的三个方法 https://lrd.im/blog/2020-01-18-b5646615e6ff.html"><span class="icon-success"></span>复制成功!</a></div>
  <div class="mobile-top"><a href="#" onclick="backToTop(4)"><span class="icon-top"></span>回到顶部</a></div>
</div>



<!-- back to top -->
<div class="to-top" id="toTop" onclick="backToTop(4)">
  <svg style="width:20px; height:40px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#232323">
      <path d="M277.375 427V167.296l119.702 119.702L427 256 256 85 85 256l29.924 29.922 119.701-118.626V427h42.75z"/>
  </svg>
</div>
<!-- end back to top -->
<!-- footer -->
<footer>
  <p class="copyright">© Pudge 2017-2021</p>
</footer>

<!-- end footer -->
</article>
<script src="https://cdn.jsdelivr.net/npm/zoom-vanilla.js/dist/zoom-vanilla.min.js"></script>
<script src="../js/lazysizes.min.js"></script>
<script src="../js/custom.js"></script>
</body>
</html>
